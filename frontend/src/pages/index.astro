---
import BaseLayout from "../layouts/BaseLayout.astro";
import RandomColor from '../components/RandomColor.astro';
import Button from '../components/Button.astro';
import ProjectSlider from "../components/ProjectSlider.svelte";
import { getCollection, type CollectionEntry } from "astro:content";

// Fetch all projects
const projects = await getCollection("projects");

// Compute featured projects
const featured = projects
  .filter((p) => p.data.featured)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())

// convert to plain objects for Svelte
const sliderProjects = featured.map(p => ({
  slug: p.slug,
  data: {
    title: p.data.title,
    description: p.data.description,
    image: p.data.image,
    tags: p.data.tags ?? []
  }
}));
---

<BaseLayout title="Home">
  <!-- Hero -->
  <section>
    <h1>
      I help businesses <RandomColor>automate</RandomColor> processes and build clean data <RandomColor>dashboards.</RandomColor>
    </h1>

    <p>
      I have experience in building end-to-end data systems transforming fragmented workflows 
	  and messy data into automated, brand-aligned visual dashboards and interactive charts.
    </p>
  </section>

  <!-- What you do -->
  <section>
    <h2>What I do</h2>

    <ul>
      <li><strong>Excel & VBA automation</strong> — faster reporting, fewer errors</li>
      <li><strong>Google Sheets & Apps Script</strong> — connected, automated workflows</li>
      <li><strong>Power BI & Looker Studio</strong> — decision-ready dashboards</li>
      <li><strong>Python & R scripting</strong> — data cleaning, automation and modeling</li>
      <li><strong>Custom visualizations</strong> — D3.js, Svelte for data-storytelling and scrollytelling</li>
      <li><strong>Web Development</strong> — Astro, React, Svelte with Vercel for clean web apps and front-end</li>
    </ul>

  </section>

 <section class="projects-section">
    
    <h2 style="margin-bottom: 0.5rem;"><RandomColor>Featured Projects</RandomColor></h2>
    
    <ProjectSlider projects={featured} client:load />
    
    <p style="margin-top: 1rem; text-align: center">
      <Button href="/projects">View all projects →</Button>
    </p>
  </section> 

<style>
  .projects-section {
    /* Prevents any horizontal scroll issues from the 100vw breakout */
    overflow-x: hidden; 
    padding: 1rem 0;
  }
</style>

  <!-- Skillset -->
  <section>
    <h2>Skillset</h2>

    <ul>
	<li>Scripting and Automation - Excel Formulas & VBA/ macros, Python in Excel for data science, Google Sheets and Apps Script </li>
	<li>Data analytics - Python, R </li>
	<li>Data Visualization - PowerBI, Google Looker studio, Python charts, d3.js </li>
	<li>Webdev - HTML, CSS, Astro, Vercel deployment, Svelte, React </li>
	<li>Databases: AccessDB, most SQL based databases </li>
	<li>CMS: Wordpress, Shopify </li>
	<li>Graphic design: Adobe Photoshop, InDesign, Coreldraw, Canva</li>
	</ul>

	<p>I do use LLMs(Claude, Gemini) to generate boilerplate code and help me focus on implementing <RandomColor>efficient</RandomColor>, secure and robust systems.</p>

  </section>

  <!-- CTA -->
   <!-- Credibility -->
  <section>
    <h2>How I work</h2>

    <p>
      I focus on understanding the problem first, then building clean,
      maintainable solutions that clients can actually use.
    </p>

    <p>
      Most of my work comes from real business needs — reporting bottlenecks,
      messy spreadsheets, and dashboards that don’t answer the right questions.
    </p>
	
	<p>
	 My Ethos: <RandomColor>Respect. Integrity. Simplicity.</RandomColor>
	 I prioritize clear communication to build sustainable long term relationships and collaborations
    </p>
	
	<p style="text-align: center;">
      <Button href="/about">Contact me →</Button>
  </p>
  </section>
</BaseLayout>