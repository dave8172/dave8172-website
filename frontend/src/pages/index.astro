---
import BaseLayout from "../layouts/BaseLayout.astro";
import RandomColor from '../components/RandomColor.astro';
import Button from '../components/Button.astro';
import ProjectSlider from "../components/ProjectSlider.svelte";
import { getCollection, type CollectionEntry } from "astro:content";

// Fetch all projects
const projects = await getCollection("projects");

// Compute featured projects
const featured = projects
  .filter((p) => p.data.featured)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())

// convert to plain objects for Svelte
const sliderProjects = featured.map(p => ({
  slug: p.slug,
  data: {
    title: p.data.title,
    description: p.data.description,
    image: p.data.image,
    tags: p.data.tags ?? []
  }
}));
---

<BaseLayout title="Home">
  <!-- Hero -->
  <section>
    <h1>
      I help businesses <RandomColor>automate</RandomColor> processes and build clean data <RandomColor>dashboards.</RandomColor>
    </h1>

    <p>
      I have experience in building end-to-end data systems transforming fragmented workflows 
	  and messy data into automated, brand-aligned visual dashboards and interactive charts.
    </p>
  </section>

 <section class="projects-section">
    
    <h2 style="margin-bottom: 0.5rem;"><RandomColor>Featured Projects</RandomColor></h2>
    
    <ProjectSlider projects={featured} client:load />
    
    <p style="margin-top: 1rem; text-align: center">
      <Button href="/projects">View all projects →</Button>
    </p>
  </section> 

<style>
  .projects-section {
    /* Prevents any horizontal scroll issues from the 100vw breakout */
    overflow-x: hidden; 
    padding: 1rem 0;
  }
</style>

  <!-- Skillset -->
  <section>
    <h2>Skillset</h2>

  <ul>
  <li>
    <strong><RandomColor>Integrating AI</RandomColor> inside workflows and data architecture</strong> — Using OpenAI and Gemini models via Python and in Excel via VBA.
  </li>

  <li>
    <strong>Data Engineering & <RandomColor>Automation</RandomColor></strong> — Leveraging Excel (VBA/Power Query), Python, SQL, BigQuery, and ETL Pipelines.
  </li>

  <li>
    <strong>Analytics & Data <RandomColor>Modeling</RandomColor></strong> — Utilizing Python (Pandas, Scikit-learn), R Scripting, and Excel Power Query.
  </li>

  <li>
    <strong>Interactive <RandomColor>Dashboards</RandomColor> & Reporting Systems</strong> — Built with PowerBI, Looker Studio, and Google Sheets Dashboards.
  </li>

  <li>
    <strong>Spreadsheet Apps & Tools</strong> — <RandomColor>Custom UI</RandomColor> via VBA Userforms, Google Apps Script, and Python in Excel.
  </li>

  <li>
    <strong>Custom Data Visualization & Storytelling</strong> — Bespoke designs using <RandomColor>D3.js</RandomColor>, Svelte, and Python (Matplotlib/Seaborn).
  </li>

  <li>
    <strong>Modern Web Applications</strong> — Developed with Astro, React, <RandomColor>Svelte</RandomColor>, and Javascript, deployed via Vercel.
  </li>
</ul>

  </section>

  <!-- CTA -->
   <!-- Credibility -->
  <section>
    <h2>My Ethos</h2>
    <p>
	    <RandomColor>Respect. Integrity. Simplicity.</RandomColor>
    </p>
    <p>
      I focus on building secure, scalable and intelligent systems, with longevity in mind, fostering trust through consistent reliability.
    </p>
    <br />
	
	<p style="text-align: center;">
      <Button href="/about">Contact me →</Button>
  </p>
  </section>
</BaseLayout>